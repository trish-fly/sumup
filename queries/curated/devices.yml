version: 2

models:
  - name: devices
    meta:
      owner: '{{ var("analytics_owner") }}'
      slack_id: '{{ var("product_analytics_patricia_slack_id") }}'
      tier: '{{ var("tier_2_data_asset") }}'

    description: '{{ doc("model_devices") }}'

    columns:
      - name: device_uuid
        description: '{{ doc("device_uuid") }}'
        tests:
          - unique
          - not_null

      - name: type_id
        description: '{{ doc("type_id") }}'
        tests:
          - accepted_values:
              values: [ 1, 2, 3, 4, 5 ]

      - name: store_id
        description: '{{ doc("store_id") }}'

#    columns:
#      - name: quantity_covered
#        description: '{{ doc("mes_quantity_sold") }}'
#        tests:
#          - dbt_expectations.expect_column_values_to_be_between:
#              min_value: 0.89
#              max_value: 1
#              row_condition: "platform = 'ios' and day_of_week != 1"
#              where: "event_date between date_sub(date('{{ var('ds') }}'), interval 1 day) and date('{{ var('ds') }}')"
#              strictly: false